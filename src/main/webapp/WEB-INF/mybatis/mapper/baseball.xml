<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="baseball">
	
	<select id="selectBaseball" resultType="baseballVo">
		SELECT B.*, BI.BASEBALL_ZONE ZONE 
		FROM BASEBALL B LEFT OUTER JOIN BASEBALL_INFO BI
		ON (B.BASE_INFO_NO = BI.BASE_INFO_NO)
		<if test="gameDate != null and gameTime != null">
			WHERE GAME_DATE = #{gameDate}
			AND GAME_TIME = #{gameTime}
		</if>
		ORDER BY B.GAME_DATE DESC
	</select>

	<select id="StatusByWeekAndZone"> <!-- 주차, 구역별 야구장 예매 현황 -->
		SELECT B.GAME_DATE, SUM(B.BUYER_CNT) AS SUM 
		FROM BASEBALL B LEFT OUTER JOIN BASEBALL_INFO BI
		ON (B.BASE_INFO_NO = BI.BASE_INFO_NO)
		WHERE B.GAME_DATE LIKE #{month}||'%' 
		AND TO_CHAR(TO_DATE(B.GAME_DATE), 'W') = #{week} <!-- 몇주차인지 -->
		GROUP BY B.GAME_DATE, BI.BASEBALL_ZONE
		<if test="zone != null">
			HAVING BI.BASEBALL_ZONE = #{zone} <!-- 구역 -->
		</if>
		ORDER BY B.GAME_DATE
	</select>
</mapper>
